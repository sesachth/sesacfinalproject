<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="~{/thymeleaf/html/common/default_layout}">

<th:block layout:fragment="css">
	<link rel="stylesheet" th:href="@{/css/admin/admin.css}" />
</th:block>

<th:block layout:fragment="wrapper">
	<div class="outside-container">
		<div class="main-container">
			<div th:replace="~{thymeleaf/html/common/include::profile}"></div>
			<div th:replace="~{thymeleaf/html/common/include::sidebar}"></div>
			<div layout:fragment="content" class="main-content">


				<!-- í•„í„° ì»¨í…Œì´ë„ˆ -->
				<div class="filter-container">
					<label for="dateFilter">ë‚ ì§œ:</label> <input type="date"
						id="dateFilter" /> <label for="destinationFilter">ìº í”„:</label> <select
						id="destinationFilter">
						<option value="">ì „ì²´</option>
						<option value="ì„œì´ˆ ìº í”„">ì„œì´ˆ ìº í”„</option>
						<option value="ê°•ë‚¨ ìº í”„">ê°•ë‚¨ ìº í”„</option>
						<option value="ê°•ì„œ ìº í”„">ê°•ì„œ ìº í”„</option>
						<option value="ì¤‘êµ¬ ìº í”„">ì¤‘êµ¬ ìº í”„</option>
						<option value="ì„±ë™ ìº í”„">ì„±ë™ ìº í”„</option>
					</select>

					<button id="filterBtn">ì¡°íšŒ</button>

					<label for="PalletIdSearch">íŒ”ë ›íŠ¸ ID:</label> <input type="text"
						id="PalletIdSearch" placeholder="íŒ”ë ›íŠ¸ ID ì…ë ¥" />
					<button id="searchPalletBtn">ê²€ìƒ‰</button>

				</div>

				<!-- íŒ”ë ›íŠ¸ í…Œì´ë¸” -->
				<div class="table-container">
					<table class="pallet-table">
						<thead>
							<tr>
								<th>Pallet ID</th>
								<th>Load</th>
								<th>Width</th>
								<th>Depth</th>
								<th>Height</th>
								<th>Destination</th>
								<th>VehicleNumber</th>
							</tr>
						</thead>
						<tbody>
							<!-- ëª¨ë¸ë¡œ ì „ë‹¬ëœ palletListê°€ ìˆì„ ê²½ìš° ê° í•­ëª©ì„ ì¶œë ¥ -->
							<tr th:each="pallet : ${palletList}">
								<td th:text="${pallet.palletId}">Pallet ID</td>
								<td th:text="${pallet.load}">Load</td>
								<td th:text="${pallet.width}">Width</td>
								<td th:text="${pallet.depth}">Depth</td>
								<td th:text="${pallet.height}">Height</td>
								<td th:text="${pallet.destination}">Destination</td>
								<td th:text="${pallet.vehicleNumber}">VehicleNumber</td>
							</tr>
							<!-- ëª©ë¡ì´ ì—†ì„ ê²½ìš° ì²˜ë¦¬ -->
							<tr th:if="${#lists.isEmpty(palletList)}">
								<td colspan="7">ë“±ë¡ëœ íŒ”ë ˆíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</td>
							</tr>
						</tbody>
					</table>
				</div>

				<tbody id="palletTableBody"></tbody>
				</table>
			</div>

			<!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
			<div class="pagination">
				<button id="prevGroup">Â«</button>
				<span id="pageNumbers"></span>
				<button id="nextGroup">Â»</button>
			</div>
		</div>
	</div>
	</div>
</th:block>

<script>
let currentPage = 1;
const rowsPerPage = 10;
const pageGroupSize = 10;
let totalPages = 1;
let progressData = [];

window.onload = () => loadPallet();

// ì¡°íšŒ ë²„íŠ¼ í´ë¦­
document.getElementById("filterBtn").addEventListener("click", function () {
    currentPage = 1;
    loadPallet(currentPage);
});


// Enter í‚¤ ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€
document.getElementById("palletIdSearch").addEventListener("keypress", function (event) {
    if (event.key === "Enter") {
        searchPalletByNum();
    }
});

// ì´ì „ / ë‹¤ìŒ ë²„íŠ¼ ì´ë²¤íŠ¸
document.getElementById("prevGroup").addEventListener("click", function () {
    if (currentPage > 1) {
        currentPage--; // âœ… í•œ í˜ì´ì§€ì”© ê°ì†Œ
        loadProgress(currentPage);
    }
});

document.getElementById("nextGroup").addEventListener("click", function () {
    if (currentPage < totalPages) {
        currentPage++; // âœ… í•œ í˜ì´ì§€ì”© ì¦ê°€
        loadProgress(currentPage);
    }
});

//í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸
function updatePagination() {
    let pageNumbers = document.getElementById("pageNumbers");
    pageNumbers.innerHTML = "";

    let startPage = Math.max(1, Math.floor((currentPage - 1) / pageGroupSize) * pageGroupSize + 1);
    let endPage = Math.min(startPage + pageGroupSize - 1, totalPages);

    console.log("ğŸ“Œ í˜ì´ì§€ë„¤ì´ì…˜ ì—…ë°ì´íŠ¸:", startPage, "â†’", endPage, "ì´ í˜ì´ì§€ ìˆ˜:", totalPages);

    for (let i = startPage; i <= endPage; i++) {
        let pageButton = document.createElement("button");
        pageButton.innerText = i;
        pageButton.classList.add("page-btn");

        if (i === currentPage) {
            pageButton.classList.add("active");
        }

        pageButton.addEventListener("click", function () {
            console.log("ğŸ“Œ í˜ì´ì§€ í´ë¦­ë¨:", i);
            if (currentPage !== i) { // ì¤‘ë³µ ìš”ì²­ ë°©ì§€
                currentPage = i;
                loadProgress(i);
            }
        });

        pageNumbers.appendChild(pageButton);
    }

    // âœ… ë²„íŠ¼ ìš”ì†Œ ì°¾ê¸°
    let prevButton = document.getElementById("prevGroup");
    let nextButton = document.getElementById("nextGroup");

    if (!prevButton || !nextButton) {
        console.error("âŒ í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
    }

    // âœ… ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±° (ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€)
    prevButton.replaceWith(prevButton.cloneNode(true));
    nextButton.replaceWith(nextButton.cloneNode(true));

    // âœ… ìƒˆë¡œ ë²„íŠ¼ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° (ì´ë²¤íŠ¸ê°€ ì—†ëŠ” ìƒˆ ë…¸ë“œ)
    prevButton = document.getElementById("prevGroup");
    nextButton = document.getElementById("nextGroup");

    // âœ… ë²„íŠ¼ ìƒíƒœ ì„¤ì •
    prevButton.disabled = (currentPage === 1);
    nextButton.disabled = (currentPage >= totalPages);

    // âœ… ì´ì „ ë²„íŠ¼ ì´ë²¤íŠ¸ ë“±ë¡
    prevButton.addEventListener("click", function () {
        if (currentPage > 1) {
            currentPage--;
            loadProgress(currentPage);
        }
    });

    // âœ… ë‹¤ìŒ ë²„íŠ¼ ì´ë²¤íŠ¸ ë“±ë¡
    nextButton.addEventListener("click", function () {
        if (currentPage < totalPages) {
            currentPage++;
            loadProgress(currentPage);
        }
    });

    console.log("ğŸ“Œ ì´ì „ ë²„íŠ¼ ìƒíƒœ:", prevButton.disabled);
    console.log("ğŸ“Œ ë‹¤ìŒ ë²„íŠ¼ ìƒíƒœ:", nextButton.disabled);
}




document.addEventListener("DOMContentLoaded", function () {
    console.log("ğŸ“Œ DOM ë¡œë“œ ì™„ë£Œ");

    let prevButton = document.getElementById("prevGroup");
    let nextButton = document.getElementById("nextGroup");

    if (prevButton) {
        prevButton.addEventListener("click", function () {
            console.log("â¬… ì´ì „ í˜ì´ì§€ ë²„íŠ¼ í´ë¦­ë¨, í˜„ì¬ í˜ì´ì§€:", currentPage);
            if (currentPage > 1) {
                currentPage--;
                loadProgress(currentPage);
            }
        });
    } else {
        console.error("âŒ ì´ì „ ë²„íŠ¼(prevGroup)ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    if (nextButton) {
        nextButton.addEventListener("click", function () {
            console.log("â¡ ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼ í´ë¦­ë¨, í˜„ì¬ í˜ì´ì§€:", currentPage, "ì´ í˜ì´ì§€ ìˆ˜:", totalPages);
            if (currentPage < totalPages) {
                currentPage++;
                loadProgress(currentPage);
            }
        });
    } else {
        console.error("âŒ ë‹¤ìŒ ë²„íŠ¼(nextGroup)ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }
});









</script>
<style>
.table-container {
	max-height: 500px;
	overflow-y: auto;
	margin-top: 10px;
}

.pallet-table {
	width: 100%;
	border-collapse: collapse;
}

.pallet-table th, .pallet-table td {
	padding: 10px;
	border: 1px solid #ddd;
	text-align: center;
}

.pagination {
	display: flex;
	justify-content: center;
	margin-top: 10px;
}

.pagination button {
	padding: 5px 10px;
	margin: 2px;
	border: none;
	background: #eee;
	cursor: pointer;
}

.pagination .active {
	background: #6200ea;
	color: white;
}

/* í…Œì´ë¸” ì»¨í…Œì´ë„ˆ */
.table-container {
	width: 100%;
	max-height: 500px;
	overflow-y: auto;
	overflow-x: auto;
	margin-top: 10px;
}

/* í…Œì´ë¸” */
.pallet-table {
	width: 100%;
	border-collapse: collapse;
	table-layout: fixed; /* ì—´ ë„ˆë¹„ ê³ ì • */
}

/* í…Œì´ë¸” í—¤ë” */
.pallet-table th {
	background: #f4f4f4;
	padding: 12px;
	border: 1px solid #ddd;
	text-align: center;
	font-weight: bold;
}

/* í…Œì´ë¸” ë³¸ë¬¸ */
.pallet-table td {
	padding: 10px;
	border: 1px solid #ddd;
	text-align: center;
	white-space: nowrap; /* í…ìŠ¤íŠ¸ ì¤„ ë°”ê¿ˆ ë°©ì§€ */
	overflow: hidden;
	text-overflow: ellipsis; /* ë„ˆë¬´ ê¸¸ë©´ ... ì²˜ë¦¬ */
}

/* ê° ì—´ í¬ê¸° ê³ ì • */
.pallet-table th:nth-child(1), .pallet-table td:nth-child(1) {
	width: 15%; /* palletId */
}

.pallet-table th:nth-child(2), .pallet-table td:nth-child(2) {
	width: 20%; /* load */
}

.pallet-table th:nth-child(3), .pallet-table td:nth-child(3) {
	width: 10%; /* width */
}

.pallet-table th:nth-child(4), .pallet-table td:nth-child(4) {
	width: 15%; /* Depth */
}

.pallet-table th:nth-child(5), .pallet-table td:nth-child(5) {
	width: 10%; /* Height */
}

.pallet-table th:nth-child(6), .pallet-table td:nth-child(6) {
	width: 10%; /* Destination */
}

.pallet-table th:nth-child(7), .pallet-table td:nth-child(7) {
	width: 10%; /* VehicleNumber */
}

/* í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ */
.pagination {
	display: flex;
	justify-content: center;
	margin-top: 10px;
}

.pagination button {
	padding: 8px 12px;
	margin: 2px;
	border: none;
	background: #eee;
	cursor: pointer;
	border-radius: 4px;
}

.pagination .active {
	background: #6200ea;
	color: white;
}
</style>
</body>
</html>



</div>
</div>
</div>
</th:block>
</html>